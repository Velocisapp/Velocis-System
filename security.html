<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>VELOCISâ„¢ | Integrated Mission Controller</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.js"></script>
    <style>
        :root { --cyan: #00f2ff; --bg: #05070a; --hud: #0b111a; }
        body { margin: 0; background: var(--bg); font-family: -apple-system, sans-serif; color: #fff; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        
        /* FIX: Absolute height ensures the 3D Matrix renders immediately */
        #map { flex: 1; width: 100%; height: 70vh; background: #000; }

        /* THE MISSION HUD */
        #hud { height: 30vh; background: var(--hud); border-top: 2px solid var(--cyan); padding: 25px; box-sizing: border-box; display: flex; flex-direction: column; justify-content: space-between; }
        .phase-tag { color: var(--cyan); font-size: 10px; font-weight: 900; letter-spacing: 2px; text-transform: uppercase; }
        .instruction { font-size: 24px; font-weight: 700; margin-top: 8px; line-height: 1.2; }
        .meta { color: #4b5563; font-size: 12px; font-family: monospace; margin-top: 5px; }

        button { margin-top: 15px; width: 100%; padding: 15px; background: var(--cyan); color: #000; border: none; border-radius: 8px; font-weight: 900; cursor: pointer; text-transform: uppercase; }
    </style>
</head>
<body>

<div id="map"></div>

<div id="hud">
    <div>
        <div id="phase" class="phase-tag">Mission Status: Initialized</div>
        <div id="instruction" class="instruction">Scan for Entrance D3 at MIA North.</div>
        <div id="metadata" class="meta">Node Anchor: 25.7955, -80.2831</div>
    </div>
    <button onclick="engine.advance()">Validate Current Node</button>
</div>

<script>
    // 1. YOUR TOKEN INTEGRATION (Sovereign Key)
    mapboxgl.accessToken = 'pk.eyJ1IjoidmVsb2Npc2RldmVsb3BlciIsImEiOiJjbWtyanA4NHcxNHk0M2twcXNibXhvdnVhIn0.9sLk_qMET9czvmbYPZ9Bkg';

    class VelocisEngine {
        constructor() {
            this.step = 0;
            this.map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/navigation-night-v1', // High-contrast Matrix style
                center: [-80.2831, 25.7955], // MIA Concourse D Entry
                zoom: 16,
                pitch: 60,
                bearing: -20
            });

            this.nodes = [
                { name: "CHECK-IN", text: "Proceed to Counters 22-34.", coords: [-80.2855, 25.7962], zoom: 17.5 },
                { name: "SECURITY", text: "Clear Security Checkpoint D.", coords: [-80.2872, 25.7968], zoom: 18 },
                { name: "OBJECTIVE", text: "Take Skytrain to Gate D32.", coords: [-80.2915, 25.7981], zoom: 18.5 }
            ];
        }

        advance() {
            if (this.step < this.nodes.length) {
                const mission = this.nodes[this.step];
                
                // Update the Matrix View
                this.map.flyTo({ center: mission.coords, zoom: mission.zoom, speed: 0.8 });
                
                // Add the Cyan Node Pin
                new mapboxgl.Marker({ color: "#00f2ff" }).setLngLat(mission.coords).addTo(this.map);

                // Update the HUD Intelligence
                document.getElementById('phase').innerText = `Mission Status: ${mission.name}`;
                document.getElementById('instruction').innerText = mission.text;
                document.getElementById('metadata').innerText = `Node Anchor: ${mission.coords[1]}, ${mission.coords[0]}`;

                this.step++;
            }
        }
    }

    const engine = new VelocisEngine();
</script>
</body>
</html>
