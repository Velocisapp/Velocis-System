<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VELOCIS‚Ñ¢ Journey Hub</title>
    <style>
        body { margin: 0; background: #010406; font-family: 'Courier New', monospace; color: white; overflow-x: hidden; }
        
        /* MASTER SCROLL CONTAINER */
        #scroll-wrapper { height: 100vh; overflow-y: scroll; scroll-snap-type: y mandatory; -webkit-overflow-scrolling: touch; }
        section { min-height: 100vh; width: 100vw; scroll-snap-align: start; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; }

        /* PERSISTENT HEADER */
        #header-box { 
            position: fixed; top: 20px; left: 5%; width: 90%; z-index: 1000;
            border: 1px solid rgba(255, 215, 0, 0.4); padding: 10px; background: rgba(0,20,20,0.85); 
            backdrop-filter: blur(10px); text-align: center;
        }
        #clock { color: #FFD700; font-size: 20px; font-weight: bold; }

        /* DISCREET TOP WINDOWS */
        .discreet-window {
            position: absolute; top: 110px; left: 5%; width: 85%; 
            background: rgba(0, 10, 15, 0.7); backdrop-filter: blur(15px);
            border-left: 4px solid #39FF14; padding: 12px; z-index: 100;
            text-align: left; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .arr-window { border-left-color: #ff5b00; }
        
        .label-tiny { font-size: 9px; font-weight: 900; color: rgba(255,255,255,0.4); text-transform: uppercase; letter-spacing: 1.5px; }
        .objective-text { font-size: 13px; color: #fff; margin-top: 4px; text-transform: uppercase; }

        /* PERSISTENT 5-EMOJI NAV */
        #persistent-nav {
            position: fixed; bottom: 35px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 15px; background: rgba(20, 40, 60, 0.6);
            backdrop-filter: blur(10px); padding: 10px 20px; border-radius: 50px;
            border: 1px solid rgba(0, 255, 255, 0.3); z-index: 9999;
        }
        .nav-item { font-size: 24px; text-decoration: none; }

        canvas { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none; }

        input { width: 100%; background: rgba(255,255,255,0.05); border: 1px solid rgba(57, 255, 20, 0.3); border-radius: 4px; color: #39FF14; padding: 8px; font-family: monospace; font-size: 12px; margin-top: 10px; outline: none; }
    </style>
</head>
<body>

    <div id="header-box">
        <div style="color: #FFD700; font-size: 10px; font-weight: 900; letter-spacing: 3px;">VELOCIS‚Ñ¢ GLOBAL SECURITY</div>
        <div id="clock">TIME: --:--:--</div>
    </div>

    <div id="scroll-wrapper">
        <section id="dep-section">
            <div class="discreet-window">
                <div class="label-tiny">Terminal Guidance: Departure</div>
                <div class="objective-text">Gate: <span id="d-gate-ui" style="color:#39FF14; font-weight:900;">TBD</span> | Status: <span id="d-status-ui">SCANNING</span></div>
                <input type="text" id="flight-input" placeholder="INPUT FLIGHT #" oninput="syncData()">
            </div>
            <canvas id="blueprint-canvas"></canvas>
        </section>

        <section id="arr-section">
            <div class="discreet-window arr-window">
                <div class="label-tiny">Terminal Guidance: Arrival</div>
                <div class="objective-text">Carousel: <span id="a-bag-ui" style="color:#ff5b00; font-weight:900;">WAIT</span> | Gate: <span id="a-gate-ui">--</span></div>
            </div>
        </section>
    </div>

    <div id="persistent-nav">
        <a href="security.html" class="nav-item">‚úàÔ∏è</a>
        <a href="sea.html" class="nav-item">üö¢</a>
        <a href="rail.html" class="nav-item">üöÜ</a>
        <a href="metro.html" class="nav-item">üöá</a>
        <a href="port.html" class="nav-item">üöó</a>
    </div>

    <script>
        const canvas = document.getElementById('blueprint-canvas');
        const ctx = canvas.getContext('2d');
        const scrollBox = document.getElementById('scroll-wrapper');
        
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();

        const API_KEY = '6973cc1546ac0bf801777b1e';
        let activeGate = "--";

        const shops = [
            { name: "SINDANCE CAFE", y: 0.2, side: -1 },
            { name: "PREMIUM LOUNGE", y: 0.5, side: 1 },
            { name: "DUTY FREE LUXE", y: 0.8, side: -1 }
        ];

        async function syncData() {
            const val = document.getElementById('flight-input').value.toUpperCase();
            if (val.length < 3) return;
            const airline = val.match(/[A-Z]+/)?.[0];
            const num = val.match(/[0-9]+/)?.[0];
            const today = new Date().toISOString().slice(0, 10).replace(/-/g, '');

            try {
                const res = await fetch(`https://api.flightapi.io/airline/${API_KEY}?num=${num}&name=${airline}&date=${today}`);
                const data = await res.json();
                if (data && data[0]) {
                    const f = data[0];
                    activeGate = f.departure?.gate || "TBD";
                    document.getElementById('d-gate-ui').innerText = activeGate;
                    document.getElementById('d-status-ui').innerText = f.status || "ACTIVE";
                    document.getElementById('a-bag-ui').innerText = f.arrival?.baggage || "READY";
                    document.getElementById('a-gate-ui').innerText = f.arrival?.gate || "--";
                }
            } catch (e) { console.error(e); }
        }

        function draw() {
            ctx.fillStyle = '#010508'; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            const scrollY = scrollBox.scrollTop;
            const scrollRatio = scrollY / canvas.height;
            const themeColor = scrollRatio < 0.5 ? '57, 255, 20' : '255, 91, 0';
            const time = Date.now() * 0.0008;

            const centerX = canvas.width / 2;
            const vanishY = canvas.height * 0.3; 

            // 1. CEILING GRID (MIA Skylight Architecture)
            ctx.lineWidth = 0.5;
            for (let i = 0; i < 8; i++) {
                let z = (i * 150 + (time * 100) % 150);
                let opacity = (1 - z / 800) * 0.2;
                ctx.strokeStyle = `rgba(${themeColor}, ${opacity})`;
                ctx.beginPath();
                ctx.moveTo(0, vanishY - z*0.5);
                ctx.lineTo(canvas.width, vanishY - z*0.5);
                ctx.stroke();
            }

            // 2. STRUCTURAL PYLONS (The 3D Columns)
            for (let j = 0; j < 4; j++) {
                let zPos = (j * 250 + (time * 120) % 250);
                let opacity = (1 - zPos / 1000) * 0.4;
                let xOffset = (zPos * 0.8) + 100;
                
                ctx.fillStyle = `rgba(${themeColor}, ${opacity})`;
                ctx.fillRect(centerX - xOffset, vanishY, 4, canvas.height);
                ctx.fillRect(centerX + xOffset, vanishY, 4, canvas.height);
                
                // Floor Reflections
                ctx.fillStyle = `rgba(${themeColor}, ${opacity * 0.2})`;
                ctx.fillRect(centerX - xOffset, canvas.height - 50, 4, 50);
                ctx.fillRect(centerX + xOffset, canvas.height - 50, 4, 50);
            }

            // 3. MULTI-LEVEL OVERPASS (MIA Skytrain / Bridges)
            ctx.strokeStyle = `rgba(${themeColor}, 0.15)`;
            ctx.lineWidth = 1;
            let bridgeY = vanishY + 50;
            ctx.strokeRect(0, bridgeY, canvas.width, 30);

            // 4. THE LEAD (Geometric Command Chevron)
            const cy = canvas.height * 0.82;
            ctx.shadowBlur = 25; 
            ctx.shadowColor = `rgba(${themeColor}, 1)`;
            ctx.fillStyle = `rgba(${themeColor}, 1)`;
            ctx.beginPath();
            ctx.moveTo(centerX, cy - 30);
            ctx.lineTo(centerX - 20, cy + 10);
            ctx.lineTo(centerX, cy);
            ctx.lineTo(centerX + 20, cy + 10);
            ctx.closePath();
            ctx.fill();
            ctx.shadowBlur = 0;

            // 5. DYNAMIC SCAN LINE (The "Lidar" Sweep)
            let scanY = (Math.sin(time * 2) * 200) + (canvas.height * 0.7);
            ctx.strokeStyle = `rgba(${themeColor}, 0.2)`;
            ctx.beginPath();
            ctx.moveTo(centerX - 300, scanY);
            ctx.lineTo(centerX + 300, scanY);
            ctx.stroke();

            // 6. COMMERCE NODES (Gold Nodes)
            shops.forEach(s => {
                let y = (s.y * canvas.height + (time * 60000)) % canvas.height; 
                if (y > canvas.height * 0.4) {
                    let alpha = Math.min(0.8, (y / canvas.height));
                    let x = centerX + (s.side * (canvas.width * 0.4));
                    ctx.strokeStyle = `rgba(255, 215, 0, ${alpha})`;
                    ctx.beginPath(); ctx.moveTo(x, y); ctx.lineTo(x, y - 50); ctx.stroke();
                    ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                    ctx.font = '900 11px Courier New';
                    ctx.textAlign = s.side === 1 ? 'left' : 'right';
                    ctx.fillText(s.name, x + (s.side * 12), y - 45);
                }
            });

            requestAnimationFrame(draw);
        }
        draw();

        setInterval(() => {
            const c = document.getElementById('clock');
            if(c) c.innerText = `TIME: ${new Date().toLocaleTimeString('en-GB')}`;
        }, 1000);
    </script>
</body>
</html>
